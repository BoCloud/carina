---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: carina-hook
webhooks:
  - name: pod-hook.carina.storage.io
    namespaceSelector:
      matchExpressions:
      - key: carina.storage.io/webhook
        operator: NotIn
        values: ["ignore"]
    clientConfig:
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURBRENDQWVpZ0F3SUJBZ0lSQU01RnVQdStCTTJmcmVBNUpZU0VrRkV3RFFZSktvWklodmNOQVFFTEJRQXcKRlRFVE1CRUdBMVVFQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TVRBMk1qZ3dNakExTWpoYUZ3MHlNakEyTWpndwpNakExTWpoYU1Dd3hLakFvQmdOVkJBTVRJV05oY21sdVlTMWpiMjUwY205c2JHVnlMbXQxWW1VdGMzbHpkR1Z0CkxuTjJZekNCbnpBTkJna3Foa2lHOXcwQkFRRUZBQU9CalFBd2dZa0NnWUVBMjRDYXFWNU1zN25lVldvTGJVdHEKWEhRZitNaDdPU3JNWEFzU1A3TWJvbUIxc0gxeHZ2dStYTVpiK2tycWtmNzRDalRGczhadTd1alFDTjNCMDFxOQpmSFBLSW15MExYNkhINTU4ZlFqQUU2RUlQYkJnZEFPRFBkU1ZDM0NlSkFZUkdSOFdxNzlKNW1NMlZKL29ubDZ4CjBQd0FsaVQrNkFJc0hLYjJISS9ISXkwQ0F3RUFBYU9CdHpDQnREQU9CZ05WSFE4QkFmOEVCQU1DQmFBd0V3WUQKVlIwbEJBd3dDZ1lJS3dZQkJRVUhBd0V3REFZRFZSMFRBUUgvQkFJd0FEQWZCZ05WSFNNRUdEQVdnQlRjcFcyego1UnJNRkNSZm1ISG9BWnB3UlhsUXhUQmVCZ05WSFJFRVZ6QlZnaEZqWVhKcGJtRXRZMjl1ZEhKdmJHeGxjb0lkClkyRnlhVzVoTFdOdmJuUnliMnhzWlhJdWEzVmlaUzF6ZVhOMFpXMkNJV05oY21sdVlTMWpiMjUwY205c2JHVnkKTG10MVltVXRjM2x6ZEdWdExuTjJZekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBUVJnTVlQS1NxTmx2UE5GUQpObi9YMThXRTRrY3hsL1FnSUdMcHZTVGU0UXlFQWZlcnFqSHptYlpNaHVDVlFBTkZtUFBZcTNhb1p2UkdPd0I1CjJWMkxsVmttOVFBd0krNndYU3RucW1XKzQ1MWF4Z2tJdGxGdEFDVmhCY3RRaHMrZ0ZKbDNqdWYybFZNT0swaTIKOGdsRUJsR2JUd3Rpd1ZTMWZodVpjVWpzWEdhbWs1SHFWTndWeTR3MmY3MzhiWi9iMytobUttZGNKOWorNXNEYwpTL21EZGNST282TDlDSHBIQlZjZE96QkdTSTdRR0dvZ1luUDNnNGdzbXJJeWdKdWJTVFhMQ0sxTU5UVFJrZ0ZrCnpqaU5sUG51WVI0Q3FTNmU3djVQcEJwQ1I1WnNDenN5NjVBRmpJemtsUWJ3TkV0Uk9ldGdsallqU20zWGF0NFQKQnJBeDJnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
      service:
        name: carina-controller
        namespace: kube-system
        path: /pod/mutate
        port: 443
    failurePolicy: Ignore
    matchPolicy: Exact
    objectSelector: {}
    reinvocationPolicy: Never
    rules:
      - operations: ["CREATE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
    admissionReviewVersions: ["v1beta1"]
    sideEffects: NoneOnDryRun
    timeoutSeconds: 30

---
apiVersion: v1
kind: Secret
metadata:
  name: mutatingwebhook
  namespace: kube-system
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURBRENDQWVpZ0F3SUJBZ0lSQU01RnVQdStCTTJmcmVBNUpZU0VrRkV3RFFZSktvWklodmNOQVFFTEJRQXcKRlRFVE1CRUdBMVVFQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TVRBMk1qZ3dNakExTWpoYUZ3MHlNakEyTWpndwpNakExTWpoYU1Dd3hLakFvQmdOVkJBTVRJV05oY21sdVlTMWpiMjUwY205c2JHVnlMbXQxWW1VdGMzbHpkR1Z0CkxuTjJZekNCbnpBTkJna3Foa2lHOXcwQkFRRUZBQU9CalFBd2dZa0NnWUVBMjRDYXFWNU1zN25lVldvTGJVdHEKWEhRZitNaDdPU3JNWEFzU1A3TWJvbUIxc0gxeHZ2dStYTVpiK2tycWtmNzRDalRGczhadTd1alFDTjNCMDFxOQpmSFBLSW15MExYNkhINTU4ZlFqQUU2RUlQYkJnZEFPRFBkU1ZDM0NlSkFZUkdSOFdxNzlKNW1NMlZKL29ubDZ4CjBQd0FsaVQrNkFJc0hLYjJISS9ISXkwQ0F3RUFBYU9CdHpDQnREQU9CZ05WSFE4QkFmOEVCQU1DQmFBd0V3WUQKVlIwbEJBd3dDZ1lJS3dZQkJRVUhBd0V3REFZRFZSMFRBUUgvQkFJd0FEQWZCZ05WSFNNRUdEQVdnQlRjcFcyego1UnJNRkNSZm1ISG9BWnB3UlhsUXhUQmVCZ05WSFJFRVZ6QlZnaEZqWVhKcGJtRXRZMjl1ZEhKdmJHeGxjb0lkClkyRnlhVzVoTFdOdmJuUnliMnhzWlhJdWEzVmlaUzF6ZVhOMFpXMkNJV05oY21sdVlTMWpiMjUwY205c2JHVnkKTG10MVltVXRjM2x6ZEdWdExuTjJZekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBUVJnTVlQS1NxTmx2UE5GUQpObi9YMThXRTRrY3hsL1FnSUdMcHZTVGU0UXlFQWZlcnFqSHptYlpNaHVDVlFBTkZtUFBZcTNhb1p2UkdPd0I1CjJWMkxsVmttOVFBd0krNndYU3RucW1XKzQ1MWF4Z2tJdGxGdEFDVmhCY3RRaHMrZ0ZKbDNqdWYybFZNT0swaTIKOGdsRUJsR2JUd3Rpd1ZTMWZodVpjVWpzWEdhbWs1SHFWTndWeTR3MmY3MzhiWi9iMytobUttZGNKOWorNXNEYwpTL21EZGNST282TDlDSHBIQlZjZE96QkdTSTdRR0dvZ1luUDNnNGdzbXJJeWdKdWJTVFhMQ0sxTU5UVFJrZ0ZrCnpqaU5sUG51WVI0Q3FTNmU3djVQcEJwQ1I1WnNDenN5NjVBRmpJemtsUWJ3TkV0Uk9ldGdsallqU20zWGF0NFQKQnJBeDJnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDWFFJQkFBS0JnUURiZ0pxcFhreXp1ZDVWYWd0dFMycGNkQi80eUhzNUtzeGNDeEkvc3h1aVlIV3dmWEcrCis3NWN4bHY2U3VxUi92Z0tOTVd6eG03dTZOQUkzY0hUV3IxOGM4b2liTFF0Zm9jZm5ueDlDTUFUb1FnOXNHQjAKQTRNOTFKVUxjSjRrQmhFWkh4YXJ2MG5tWXpaVW4raWVYckhRL0FDV0pQN29BaXdjcHZZY2o4Y2pMUUlEQVFBQgpBb0dCQU5rV1o5LzZFNEhzNGFjNEtmVCtFVU0rMWlBR3AxZnlyQXFjS0lBM2M2MDBHVEZqMzRzekR5SlNTOFZQCk1vOFJ5OTdNTW51S1ZVeVRsS3d3SmZJU1hETlVYTHdiZVVSZTBTemw3Sm9xSVZqdjFOMG5mZmRVSmZGL1R5NEgKRGxnN3pWaGdQZngrS3BXQVJYMGkvdzBBK2FjS0NTeDRoNU80NDNOQTJ5NUFnWmdCQWtFQTllSEIrVnQza2pYNQp0VHNMMnpZQ25LdFdiN3doV3ZjbnN0Q1F5V2swVWNFME9PV2k5UGg3UkRSd0FNaGQxOC9xTUdHbjFOenZkbXJJCkVxWmdVMk1IVFFKQkFPU0k4NWo5TkxqYTNZYVNaTVBsYnV0SWtSSGx1ODRvbUt1bm5COFp3Lzg5QzdYQ2RRNnEKa2pJTWRPeDlwemVzZUlHKzhkaGRFb1JWU0k0d0ZCZk5XMkVDUUhQUmNXTVptSXNBYmF6V01WR0NjVnlHd0dKRgpSWmpwam9PR0JvMDR4dkl6aFh1L2Z6RFEwbzlmKzlvQ2gyR2VoL3RlSklYNXc3b050a3hDbm1EbzVva0NRR09NCjFMQWIvRTlaNTQyclQ0R1YrODg1K1JlV3YweDZtcWFMaUpKem90RVlRbldXazI4a0ZqTC9BaC9TVEhrUUJCNWcKa3ZEdytoUHpJbnZ0clpNQXZZRUNRUUNnemF4dFFqZ0orejhqMVd3K0g3VWFyQUVZbTVETkNaSlY4cGJYTVZVYgp4M0EwYnRrM1Rrc2xFNS9kelRtT3JXVWh4V0c0dDJubDVWRnFDdXkrSVFZVQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=

